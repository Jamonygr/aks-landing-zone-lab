[gitleaks]
title = "AKS Landing Zone Lab - Secret Scanning"

[[rules]]
id = "azure-storage-key"
description = "Azure Storage Account Key"
regex = '''(?i)(AccountKey|storage[_-]?key)\s*=\s*[A-Za-z0-9+/=]{40,}'''

[[rules]]
id = "azure-connection-string"
description = "Azure Connection String"
regex = '''(?i)DefaultEndpointsProtocol=https?;AccountName=[^;]+;AccountKey=[A-Za-z0-9+/=]+;'''

[[rules]]
id = "terraform-state"
description = "Terraform State Secrets"
regex = '''(?i)(client_secret|password|access_key)\s*=\s*"[^"]+"'''

[allowlist]
paths = [
  '''\.tfvars\.example$''',
  '''\.md$''',
  '''lab-plan\.txt$''',
]
